{% extends "base.html" %}

{% block title %}Users - Admin{% endblock %}

{% block content %}
<style>
    .admin-container { max-width: 1400px; margin: 0 auto; padding: 20px; }
    .admin-header { margin-bottom: 30px; }
    .search-box {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }
    .search-box input {
        flex: 1;
        padding: 12px 20px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 10px;
        color: white;
        font-size: 1rem;
    }
    .users-table {
        background: var(--bg-card);
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid var(--border);
    }
    .table-header, .table-row {
        display: grid;
        grid-template-columns: 2fr 2fr 1fr 1fr 1fr 1.5fr;
        padding: 15px 20px;
        align-items: center;
    }
    .table-header {
        background: var(--bg-dark);
        font-weight: 600;
        color: var(--text-secondary);
        font-size: 0.85rem;
        text-transform: uppercase;
    }
    .table-row {
        border-top: 1px solid var(--border);
    }
    .table-row:hover { background: var(--bg-hover); }
    .user-info { display: flex; flex-direction: column; }
    .user-name { font-weight: 600; }
    .user-email { font-size: 0.85rem; color: var(--text-secondary); }
    .pagination {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }
    .page-link {
        padding: 10px 20px;
        background: var(--bg-card);
        border-radius: 10px;
        color: white;
        text-decoration: none;
    }
    .page-link.active { background: var(--primary); }
</style>

<div class="admin-container">
    <div class="admin-header">
        <h1>ğŸ‘¥ Users Management</h1>
        <a href="{{ url_for('admin.dashboard') }}" class="btn btn-secondary">â† Back</a>
    </div>
    
    <form class="search-box" method="get">
        <input type="text" name="q" placeholder="Search users..." value="{{ search }}">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
    
    <div class="users-table">
        <div class="table-header">
            <div>User</div>
            <div>Email</div>
            <div>Credits</div>
            <div>Analyses</div>
            <div>Status</div>
            <div>Actions</div>
        </div>
        
        {% for user in users.items %}
        <div class="table-row">
            <div class="user-info">
                <span class="user-name">{{ user.username }}</span>
                <span style="font-size: 0.8rem; color: var(--text-secondary);">ID: {{ user.id }}</span>
            </div>
            <div class="user-email">{{ user.email }}</div>
            <div>{{ user.credits }} ğŸ’</div>
            <div>{{ user.analyses|length }}</div>
            <div>
                {% if user.is_admin %}
                <span style="color: var(--warning);">ğŸ‘‘ Admin</span>
                {% elif user.is_active %}
                <span style="color: var(--success);">Active</span>
                {% else %}
                <span style="color: var(--danger);">Banned</span>
                {% endif %}
            </div>
            <div>
                <a href="{{ url_for('admin.user_detail', user_id=user.id) }}" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.85rem;">Manage</a>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="pagination">
        {% if users.has_prev %}
        <a href="{{ url_for('admin.users', page=users.prev_num, q=search) }}" class="page-link">â† Previous</a>
        {% endif %}
        
        <span class="page-link active">Page {{ users.page }} of {{ users.pages }}</span>
        
        {% if users.has_next %}
        <a href="{{ url_for('admin.users', page=users.next_num, q=search) }}" class="page-link">Next â†’</a>
        {% endif %}
    </div>
</div>
{% endblock %}
